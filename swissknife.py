from glitter import *


def printMenu():
    print("Welcome to the glitter swiss knife!")
    print("Please choose from the options below the way you want to pentest product:")
    print("\t[0] - Exit")
    print("\t[1] - find vulnerabilities in the website")
    print("\t[2] - find vulnerabilities in the app\n")


def getChoice():
    printMenu()
    choice = input(">> ")
    while choice != "1" and choice != "2" and choice != "0":
        print("Invalid choice , try again")
        choice = input(">> ")

    return choice


def getAppMenuChoice():
    print("Please choose what one of the options below:")
    print("\t[0] - EXIT")
    print("\t[1] - Add likes to one of your glits")
    print("\t[2] - Add a like to one of your glits with different username")
    print("\t[3] - Post a glit with a different color")
    print("\t[4] - Post a glit with a different avatar")
    print("\t[5] - Post a glit with a different date")
    print("\t[6] - Post a glit with a different font color")
    print("\t[7] - Remove other user likes")
    print("\t[8] - Post a comment with a different date")
    print("\t[9] - Post a comment with a different username")

    choice = input(">> ")
    while choice not in [str(i) for i in range(0, 10)]:
        print("Invalid choice , try again")
        choice = input(">> ")

    return choice


def getWebsiteMenuChoice():
    print("Here are all of the sloved challenges, please choose one of them: ")
    print("\t[0] - EXIT")
    print("\t[1] - Login challenge")
    print("\t[2] - Password challenge")
    print("\t[3] - Cookie challenge")
    print("\t[4] - Privacy challenge")
    print("\t[5] - XSRF challenge")

    choice = input(">> ")
    while choice not in [str(i) for i in range(0, 6)]:
        print("Invalid choice , try again")
        choice = input(">> ")

    return choice


def penTestwebsite():

    print("Cool!\nBefore we will go through all of the challenges, please login to your account:")
    username = input("Enter username: ")
    password = input("Enter password: ")
    account_data = loginWebsite(username, password)
    print(account_data)
    if account_data == None:
        print("Error, couldn't login to this account.")
        return

    choice = ""
    while choice != "0":
        choice = getWebsiteMenuChoice()
        if choice == "2":
            passwordChallenge(account_data)


def penTestapp():
    server_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_sock.connect((SERVER_IP, SERVER_PORT))

    print("Cool!\nBefore we will go through all of the vulnerabilities, please login to your account:")
    username = input("Enter username: ")
    password = input("Enter password: ")
    account_data = loginApp(username, password, server_sock)
    print(account_data)
    if account_data == None:
        print("Error, couldn't login to this account.")
        return
    choice = ""
    while choice != "0":
        choice = getAppMenuChoice()
        if choice == "0":
            continue
        if choice == "1":
            LikesToGlit(server_sock, account_data)
        elif choice == "2":
            LikesToGlitDifferentUsername(server_sock, account_data)
        elif choice == "3":
            postGlitDifferentColor(server_sock, account_data)
        elif choice == "4":
            postGlitDifferentAvatar(server_sock, account_data)
        elif choice == "5":
            postGlitDifferentDate(server_sock, account_data)
        elif choice == "6":
            postGlitDifferentFontColor(server_sock, account_data)
        elif choice == "7":
            removeOtherUserLike(server_sock, account_data)
        elif choice == "8":
            postCommentDifferentDate(server_sock, account_data)
        elif choice == "9":
            postCommentDifferentUsername(server_sock, account_data)
        else:
            print("Invalid choice, try again")


def main():

    choice = "-1"
    while choice != "0":
        choice = getChoice()
        if choice == "1":
            penTestwebsite()
        if choice == "2":
            penTestapp()


if __name__ == '__main__':
    main()
